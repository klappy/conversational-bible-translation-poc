
import {createRequire as ___nfyCreateRequire} from "module";
import {fileURLToPath as ___nfyFileURLToPath} from "url";
import {dirname as ___nfyPathDirname} from "path";
let __filename=___nfyFileURLToPath(import.meta.url);
let __dirname=___nfyPathDirname(___nfyFileURLToPath(import.meta.url));
let require=___nfyCreateRequire(import.meta.url);


// netlify/functions/canvas-state.js
import { getStore } from "@netlify/blobs";
var DEFAULT_STATE = {
  styleGuide: {
    userName: null,
    // User's name - collected first
    conversationLanguage: "English",
    // Default value
    sourceLanguage: "English",
    // Default value
    targetLanguage: "English",
    // Default value
    languagePair: "English \u2192 English",
    // Legacy, kept for compatibility
    readingLevel: "Grade 1",
    // Default value
    tone: "Straightforward and hopeful",
    // Default value
    philosophy: "Meaning-based",
    // Default value
    approach: "Dynamic",
    // Translation approach default
    targetCommunity: "Teens"
    // Default audience
  },
  settingsCustomized: false,
  // Track if user has customized settings
  glossary: {
    keyTerms: {},
    // Biblical terms (judges, famine, Bethlehem, Moab)
    userPhrases: {}
    // User's translations of each phrase (valuable training data)
  },
  scriptureCanvas: {
    verses: {}
  },
  feedback: {
    comments: []
  },
  workflow: {
    currentPhase: "planning",
    currentVerse: "Ruth 1:1",
    // Default verse to work with
    currentPhrase: 0,
    phrasesCompleted: {},
    totalPhrases: 0
  },
  metadata: {
    lastUpdated: (/* @__PURE__ */ new Date()).toISOString(),
    version: 1
  }
};
function getBlobStore(context) {
  const storeConfig = {
    name: "canvas-state"
  };
  if (context.site?.id) {
    storeConfig.siteID = context.site.id;
  }
  if (context.token) {
    storeConfig.token = context.token;
  }
  return getStore(storeConfig);
}
function getStateKey(req) {
  const url = new URL(req.url);
  const sessionId = req.headers.get?.("x-session-id") || req.headers["x-session-id"] || url.searchParams.get("session");
  if (!sessionId) return "default";
  return sessionId.startsWith("session_") ? sessionId : `session_${sessionId}`;
}
async function loadState(store, stateKey) {
  try {
    const data = await store.get(stateKey);
    if (data) {
      return JSON.parse(data);
    }
    return { ...DEFAULT_STATE };
  } catch (error) {
    console.error("Error loading state from Blobs:", error);
    return { ...DEFAULT_STATE };
  }
}
async function saveState(store, stateKey, state) {
  try {
    await store.set(stateKey, JSON.stringify(state));
    return true;
  } catch (error) {
    console.error("Error saving state to Blobs:", error);
    return false;
  }
}
async function getState(store, stateKey) {
  const globalState = await loadState(store, stateKey);
  return {
    ...globalState,
    metadata: {
      ...globalState.metadata,
      retrieved: (/* @__PURE__ */ new Date()).toISOString(),
      sessionId: stateKey
    }
  };
}
async function updateState(store, stateKey, updates) {
  try {
    if (!updates || typeof updates !== "object") {
      throw new Error("Invalid updates provided");
    }
    let globalState = await loadState(store, stateKey);
    globalState = deepMerge(globalState, updates);
    globalState.metadata.lastUpdated = (/* @__PURE__ */ new Date()).toISOString();
    globalState.metadata.version = (globalState.metadata.version || 1) + 1;
    await saveState(store, stateKey, globalState);
    return {
      success: true,
      state: await getState(store, stateKey)
    };
  } catch (error) {
    return {
      success: false,
      error: error.message
    };
  }
}
async function resetState(store, stateKey) {
  const globalState = {
    ...DEFAULT_STATE,
    metadata: {
      lastUpdated: (/* @__PURE__ */ new Date()).toISOString(),
      version: 1,
      sessionId: stateKey
    }
  };
  await saveState(store, stateKey, globalState);
  return getState(store, stateKey);
}
async function listSessions(store) {
  try {
    const { blobs } = await store.list();
    return blobs.map((blob) => ({
      key: blob.key,
      // Extract session ID from key
      sessionId: blob.key.startsWith("session_") ? blob.key.replace("session_", "") : blob.key,
      isDefault: blob.key === "default"
    }));
  } catch (error) {
    console.error("Error listing sessions:", error);
    return [];
  }
}
function deepMerge(target, source) {
  const output = { ...target };
  if (isObject(target) && isObject(source)) {
    Object.keys(source).forEach((key) => {
      if (isObject(source[key])) {
        if (!(key in target)) {
          output[key] = source[key];
        } else {
          output[key] = deepMerge(target[key], source[key]);
        }
      } else {
        output[key] = source[key];
      }
    });
  }
  return output;
}
function isObject(item) {
  return item && typeof item === "object" && !Array.isArray(item);
}
var handler = async (req, context) => {
  const headers = {
    "Access-Control-Allow-Origin": "*",
    "Access-Control-Allow-Headers": "Content-Type, X-Session-ID",
    "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
    "Content-Type": "application/json"
  };
  if (req.method === "OPTIONS") {
    return new Response("OK", { headers });
  }
  try {
    const store = getBlobStore(context);
    const stateKey = getStateKey(req);
    const url = new URL(req.url);
    const path = url.pathname.replace("/.netlify/functions/canvas-state", "");
    console.log(`Canvas state request: ${req.method} ${path}, session: ${stateKey}`);
    if (req.method === "GET" && (path === "" || path === "/")) {
      const shouldReset = url.searchParams.get("reset") === "true";
      if (shouldReset) {
        console.log(`Resetting session via GET: ${stateKey}`);
        const state2 = await resetState(store, stateKey);
        return new Response(
          JSON.stringify({
            ...state2,
            metadata: {
              ...state2.metadata,
              reset: true,
              message: "Session reset successfully"
            }
          }),
          {
            status: 200,
            headers
          }
        );
      }
      const state = await getState(store, stateKey);
      return new Response(JSON.stringify(state), {
        status: 200,
        headers
      });
    }
    if (req.method === "GET" && path === "/sessions") {
      const sessions = await listSessions(store);
      return new Response(
        JSON.stringify({
          sessions,
          currentSession: stateKey
        }),
        {
          status: 200,
          headers
        }
      );
    }
    if (req.method === "GET" && path === "/history") {
      const state = await getState(store, stateKey);
      return new Response(
        JSON.stringify({
          history: [],
          // No longer storing history with Blobs approach
          currentState: state
        }),
        {
          status: 200,
          headers
        }
      );
    }
    if (req.method === "POST" && path === "/update") {
      const body = await req.json();
      const { updates, agentId } = body;
      const result = await updateState(store, stateKey, updates, agentId);
      return new Response(JSON.stringify(result), {
        status: result.success ? 200 : 400,
        headers
      });
    }
    if (req.method === "POST" && path === "/reset") {
      const state = await resetState(store, stateKey);
      return new Response(
        JSON.stringify({
          success: true,
          state
        }),
        {
          status: 200,
          headers
        }
      );
    }
    if (req.method === "DELETE" && path === "/session") {
      try {
        await store.delete(stateKey);
        return new Response(
          JSON.stringify({
            success: true,
            message: `Session ${stateKey} deleted`
          }),
          {
            status: 200,
            headers
          }
        );
      } catch (error) {
        return new Response(
          JSON.stringify({
            success: false,
            error: error.message
          }),
          {
            status: 500,
            headers
          }
        );
      }
    }
    return new Response(
      JSON.stringify({
        error: `Method ${req.method} not allowed for path ${path}`
      }),
      {
        status: 405,
        headers
      }
    );
  } catch (error) {
    console.error("Canvas state error:", error);
    return new Response(
      JSON.stringify({
        error: "Failed to process canvas state request",
        details: error.message
      }),
      {
        status: 500,
        headers: {
          ...headers,
          "Content-Type": "application/json"
        }
      }
    );
  }
};
var canvas_state_default = handler;
export {
  canvas_state_default as default
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibmV0bGlmeS9mdW5jdGlvbnMvY2FudmFzLXN0YXRlLmpzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyIvKipcbiAqIENhbnZhcyBTdGF0ZSBNYW5hZ2VtZW50IHdpdGggTmV0bGlmeSBCbG9ic1xuICogTWFuYWdlcyB0aGUgc3RhdGUgb2YgYWxsIGNhbnZhcyBhcnRpZmFjdHMgdXNpbmcgTmV0bGlmeSBCbG9icyBmb3IgcGVyc2lzdGVuY2VcbiAqIFRoaXMgaXMgdGhlIHNpbmdsZSBzb3VyY2Ugb2YgdHJ1dGggZm9yIHRoZSBhcHBsaWNhdGlvbiBzdGF0ZVxuICovXG5cbmltcG9ydCB7IGdldFN0b3JlIH0gZnJvbSBcIkBuZXRsaWZ5L2Jsb2JzXCI7XG5cbi8vIERlZmF1bHQgc3RhdGVcbmNvbnN0IERFRkFVTFRfU1RBVEUgPSB7XG4gIHN0eWxlR3VpZGU6IHtcbiAgICB1c2VyTmFtZTogbnVsbCwgLy8gVXNlcidzIG5hbWUgLSBjb2xsZWN0ZWQgZmlyc3RcbiAgICBjb252ZXJzYXRpb25MYW5ndWFnZTogXCJFbmdsaXNoXCIsIC8vIERlZmF1bHQgdmFsdWVcbiAgICBzb3VyY2VMYW5ndWFnZTogXCJFbmdsaXNoXCIsIC8vIERlZmF1bHQgdmFsdWVcbiAgICB0YXJnZXRMYW5ndWFnZTogXCJFbmdsaXNoXCIsIC8vIERlZmF1bHQgdmFsdWVcbiAgICBsYW5ndWFnZVBhaXI6IFwiRW5nbGlzaCBcdTIxOTIgRW5nbGlzaFwiLCAvLyBMZWdhY3ksIGtlcHQgZm9yIGNvbXBhdGliaWxpdHlcbiAgICByZWFkaW5nTGV2ZWw6IFwiR3JhZGUgMVwiLCAvLyBEZWZhdWx0IHZhbHVlXG4gICAgdG9uZTogXCJTdHJhaWdodGZvcndhcmQgYW5kIGhvcGVmdWxcIiwgLy8gRGVmYXVsdCB2YWx1ZVxuICAgIHBoaWxvc29waHk6IFwiTWVhbmluZy1iYXNlZFwiLCAvLyBEZWZhdWx0IHZhbHVlXG4gICAgYXBwcm9hY2g6IFwiRHluYW1pY1wiLCAvLyBUcmFuc2xhdGlvbiBhcHByb2FjaCBkZWZhdWx0XG4gICAgdGFyZ2V0Q29tbXVuaXR5OiBcIlRlZW5zXCIsIC8vIERlZmF1bHQgYXVkaWVuY2VcbiAgfSxcbiAgc2V0dGluZ3NDdXN0b21pemVkOiBmYWxzZSwgLy8gVHJhY2sgaWYgdXNlciBoYXMgY3VzdG9taXplZCBzZXR0aW5nc1xuICBnbG9zc2FyeToge1xuICAgIGtleVRlcm1zOiB7fSwgLy8gQmlibGljYWwgdGVybXMgKGp1ZGdlcywgZmFtaW5lLCBCZXRobGVoZW0sIE1vYWIpXG4gICAgdXNlclBocmFzZXM6IHt9LCAvLyBVc2VyJ3MgdHJhbnNsYXRpb25zIG9mIGVhY2ggcGhyYXNlICh2YWx1YWJsZSB0cmFpbmluZyBkYXRhKVxuICB9LFxuICBzY3JpcHR1cmVDYW52YXM6IHtcbiAgICB2ZXJzZXM6IHt9LFxuICB9LFxuICBmZWVkYmFjazoge1xuICAgIGNvbW1lbnRzOiBbXSxcbiAgfSxcbiAgd29ya2Zsb3c6IHtcbiAgICBjdXJyZW50UGhhc2U6IFwicGxhbm5pbmdcIixcbiAgICBjdXJyZW50VmVyc2U6IFwiUnV0aCAxOjFcIiwgLy8gRGVmYXVsdCB2ZXJzZSB0byB3b3JrIHdpdGhcbiAgICBjdXJyZW50UGhyYXNlOiAwLFxuICAgIHBocmFzZXNDb21wbGV0ZWQ6IHt9LFxuICAgIHRvdGFsUGhyYXNlczogMCxcbiAgfSxcbiAgbWV0YWRhdGE6IHtcbiAgICBsYXN0VXBkYXRlZDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgIHZlcnNpb246IDEsXG4gIH0sXG59O1xuXG4vKipcbiAqIEdldCB0aGUgTmV0bGlmeSBCbG9icyBzdG9yZSBmb3IgdGhlIGN1cnJlbnQgc2l0ZVxuICovXG5mdW5jdGlvbiBnZXRCbG9iU3RvcmUoY29udGV4dCkge1xuICAvLyBJbiBwcm9kdWN0aW9uLCBnZXRTdG9yZSBzaG91bGQgd29yayB3aXRob3V0IGV4cGxpY2l0IHNpdGVJRC90b2tlblxuICAvLyBhcyBOZXRsaWZ5IHByb3ZpZGVzIHRoZXNlIGF1dG9tYXRpY2FsbHkgaW4gdGhlIHJ1bnRpbWUgZW52aXJvbm1lbnRcbiAgY29uc3Qgc3RvcmVDb25maWcgPSB7XG4gICAgbmFtZTogXCJjYW52YXMtc3RhdGVcIixcbiAgfTtcblxuICAvLyBPbmx5IGFkZCBzaXRlSUQgYW5kIHRva2VuIGlmIHRoZXkgZXhpc3QgKGZvciBsb2NhbCBkZXZlbG9wbWVudClcbiAgaWYgKGNvbnRleHQuc2l0ZT8uaWQpIHtcbiAgICBzdG9yZUNvbmZpZy5zaXRlSUQgPSBjb250ZXh0LnNpdGUuaWQ7XG4gIH1cblxuICBpZiAoY29udGV4dC50b2tlbikge1xuICAgIHN0b3JlQ29uZmlnLnRva2VuID0gY29udGV4dC50b2tlbjtcbiAgfVxuXG4gIHJldHVybiBnZXRTdG9yZShzdG9yZUNvbmZpZyk7XG59XG5cbi8qKlxuICogR2V0IHNlc3Npb24tc3BlY2lmaWMgc3RhdGUga2V5XG4gKi9cbmZ1bmN0aW9uIGdldFN0YXRlS2V5KHJlcSkge1xuICAvLyBDaGVjayBmb3Igc2Vzc2lvbiBJRCBpbiBoZWFkZXJzIG9yIHF1ZXJ5IHBhcmFtc1xuICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcS51cmwpO1xuICBjb25zdCBzZXNzaW9uSWQgPVxuICAgIHJlcS5oZWFkZXJzLmdldD8uKFwieC1zZXNzaW9uLWlkXCIpIHx8XG4gICAgcmVxLmhlYWRlcnNbXCJ4LXNlc3Npb24taWRcIl0gfHxcbiAgICB1cmwuc2VhcmNoUGFyYW1zLmdldChcInNlc3Npb25cIik7XG5cbiAgLy8gVXNlIHNlc3Npb24tc3BlY2lmaWMga2V5IGlmIHByb3ZpZGVkLCBvdGhlcndpc2UgdXNlIGRlZmF1bHRcbiAgLy8gRG9uJ3QgZG91YmxlLXByZWZpeCBpZiBzZXNzaW9uIElEIGFscmVhZHkgc3RhcnRzIHdpdGggXCJzZXNzaW9uX1wiXG4gIGlmICghc2Vzc2lvbklkKSByZXR1cm4gXCJkZWZhdWx0XCI7XG4gIHJldHVybiBzZXNzaW9uSWQuc3RhcnRzV2l0aChcInNlc3Npb25fXCIpID8gc2Vzc2lvbklkIDogYHNlc3Npb25fJHtzZXNzaW9uSWR9YDtcbn1cblxuLyoqXG4gKiBMb2FkIHN0YXRlIGZyb20gQmxvYnMgb3IgcmV0dXJuIGRlZmF1bHRcbiAqL1xuYXN5bmMgZnVuY3Rpb24gbG9hZFN0YXRlKHN0b3JlLCBzdGF0ZUtleSkge1xuICB0cnkge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBzdG9yZS5nZXQoc3RhdGVLZXkpO1xuICAgIGlmIChkYXRhKSB7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShkYXRhKTtcbiAgICB9XG4gICAgLy8gTm8gZXhpc3Rpbmcgc3RhdGUsIHJldHVybiBkZWZhdWx0XG4gICAgcmV0dXJuIHsgLi4uREVGQVVMVF9TVEFURSB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBsb2FkaW5nIHN0YXRlIGZyb20gQmxvYnM6XCIsIGVycm9yKTtcbiAgICAvLyBSZXR1cm4gZGVmYXVsdCBzdGF0ZSBvbiBlcnJvclxuICAgIHJldHVybiB7IC4uLkRFRkFVTFRfU1RBVEUgfTtcbiAgfVxufVxuXG4vKipcbiAqIFNhdmUgc3RhdGUgdG8gQmxvYnNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2F2ZVN0YXRlKHN0b3JlLCBzdGF0ZUtleSwgc3RhdGUpIHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBzdG9yZS5zZXQoc3RhdGVLZXksIEpTT04uc3RyaW5naWZ5KHN0YXRlKSk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIHNhdmluZyBzdGF0ZSB0byBCbG9iczpcIiwgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vKipcbiAqIEdldCB0aGUgY3VycmVudCBzdGF0ZVxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRTdGF0ZShzdG9yZSwgc3RhdGVLZXkpIHtcbiAgY29uc3QgZ2xvYmFsU3RhdGUgPSBhd2FpdCBsb2FkU3RhdGUoc3RvcmUsIHN0YXRlS2V5KTtcbiAgcmV0dXJuIHtcbiAgICAuLi5nbG9iYWxTdGF0ZSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgLi4uZ2xvYmFsU3RhdGUubWV0YWRhdGEsXG4gICAgICByZXRyaWV2ZWQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIHNlc3Npb25JZDogc3RhdGVLZXksXG4gICAgfSxcbiAgfTtcbn1cblxuLyoqXG4gKiBVcGRhdGUgdGhlIHN0YXRlIHdpdGggdmFsaWRhdGlvblxuICovXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVTdGF0ZShzdG9yZSwgc3RhdGVLZXksIHVwZGF0ZXMpIHtcbiAgdHJ5IHtcbiAgICAvLyBWYWxpZGF0ZSB1cGRhdGVzXG4gICAgaWYgKCF1cGRhdGVzIHx8IHR5cGVvZiB1cGRhdGVzICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHVwZGF0ZXMgcHJvdmlkZWRcIik7XG4gICAgfVxuXG4gICAgLy8gTG9hZCBjdXJyZW50IHN0YXRlXG4gICAgbGV0IGdsb2JhbFN0YXRlID0gYXdhaXQgbG9hZFN0YXRlKHN0b3JlLCBzdGF0ZUtleSk7XG5cbiAgICAvLyBBcHBseSB1cGRhdGVzIChkZWVwIG1lcmdlKVxuICAgIGdsb2JhbFN0YXRlID0gZGVlcE1lcmdlKGdsb2JhbFN0YXRlLCB1cGRhdGVzKTtcblxuICAgIC8vIFVwZGF0ZSBtZXRhZGF0YVxuICAgIGdsb2JhbFN0YXRlLm1ldGFkYXRhLmxhc3RVcGRhdGVkID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgIGdsb2JhbFN0YXRlLm1ldGFkYXRhLnZlcnNpb24gPSAoZ2xvYmFsU3RhdGUubWV0YWRhdGEudmVyc2lvbiB8fCAxKSArIDE7XG5cbiAgICAvLyBTYXZlIHRvIEJsb2JzXG4gICAgYXdhaXQgc2F2ZVN0YXRlKHN0b3JlLCBzdGF0ZUtleSwgZ2xvYmFsU3RhdGUpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBzdGF0ZTogYXdhaXQgZ2V0U3RhdGUoc3RvcmUsIHN0YXRlS2V5KSxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBSZXNldCBzdGF0ZSB0byBpbml0aWFsIHZhbHVlc1xuICovXG5hc3luYyBmdW5jdGlvbiByZXNldFN0YXRlKHN0b3JlLCBzdGF0ZUtleSkge1xuICBjb25zdCBnbG9iYWxTdGF0ZSA9IHtcbiAgICAuLi5ERUZBVUxUX1NUQVRFLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBsYXN0VXBkYXRlZDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgdmVyc2lvbjogMSxcbiAgICAgIHNlc3Npb25JZDogc3RhdGVLZXksXG4gICAgfSxcbiAgfTtcbiAgYXdhaXQgc2F2ZVN0YXRlKHN0b3JlLCBzdGF0ZUtleSwgZ2xvYmFsU3RhdGUpO1xuICByZXR1cm4gZ2V0U3RhdGUoc3RvcmUsIHN0YXRlS2V5KTtcbn1cblxuLyoqXG4gKiBMaXN0IGFsbCBzZXNzaW9ucyAoZm9yIGFkbWluL2RlYnVnIHB1cnBvc2VzKVxuICovXG5hc3luYyBmdW5jdGlvbiBsaXN0U2Vzc2lvbnMoc3RvcmUpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGJsb2JzIH0gPSBhd2FpdCBzdG9yZS5saXN0KCk7XG4gICAgcmV0dXJuIGJsb2JzLm1hcCgoYmxvYikgPT4gKHtcbiAgICAgIGtleTogYmxvYi5rZXksXG4gICAgICAvLyBFeHRyYWN0IHNlc3Npb24gSUQgZnJvbSBrZXlcbiAgICAgIHNlc3Npb25JZDogYmxvYi5rZXkuc3RhcnRzV2l0aChcInNlc3Npb25fXCIpID8gYmxvYi5rZXkucmVwbGFjZShcInNlc3Npb25fXCIsIFwiXCIpIDogYmxvYi5rZXksXG4gICAgICBpc0RlZmF1bHQ6IGJsb2Iua2V5ID09PSBcImRlZmF1bHRcIixcbiAgICB9KSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGxpc3Rpbmcgc2Vzc2lvbnM6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gW107XG4gIH1cbn1cblxuLyoqXG4gKiBEZWVwIG1lcmdlIHV0aWxpdHkgZnVuY3Rpb25cbiAqL1xuZnVuY3Rpb24gZGVlcE1lcmdlKHRhcmdldCwgc291cmNlKSB7XG4gIGNvbnN0IG91dHB1dCA9IHsgLi4udGFyZ2V0IH07XG5cbiAgaWYgKGlzT2JqZWN0KHRhcmdldCkgJiYgaXNPYmplY3Qoc291cmNlKSkge1xuICAgIE9iamVjdC5rZXlzKHNvdXJjZSkuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICBpZiAoaXNPYmplY3Qoc291cmNlW2tleV0pKSB7XG4gICAgICAgIGlmICghKGtleSBpbiB0YXJnZXQpKSB7XG4gICAgICAgICAgb3V0cHV0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvdXRwdXRba2V5XSA9IGRlZXBNZXJnZSh0YXJnZXRba2V5XSwgc291cmNlW2tleV0pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvdXRwdXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIG91dHB1dDtcbn1cblxuZnVuY3Rpb24gaXNPYmplY3QoaXRlbSkge1xuICByZXR1cm4gaXRlbSAmJiB0eXBlb2YgaXRlbSA9PT0gXCJvYmplY3RcIiAmJiAhQXJyYXkuaXNBcnJheShpdGVtKTtcbn1cblxuLyoqXG4gKiBOZXRsaWZ5IEZ1bmN0aW9uIEhhbmRsZXJcbiAqL1xuY29uc3QgaGFuZGxlciA9IGFzeW5jIChyZXEsIGNvbnRleHQpID0+IHtcbiAgLy8gRW5hYmxlIENPUlNcbiAgY29uc3QgaGVhZGVycyA9IHtcbiAgICBcIkFjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpblwiOiBcIipcIixcbiAgICBcIkFjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnNcIjogXCJDb250ZW50LVR5cGUsIFgtU2Vzc2lvbi1JRFwiLFxuICAgIFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctTWV0aG9kc1wiOiBcIkdFVCwgUE9TVCwgUFVULCBERUxFVEUsIE9QVElPTlNcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfTtcblxuICAvLyBIYW5kbGUgcHJlZmxpZ2h0XG4gIGlmIChyZXEubWV0aG9kID09PSBcIk9QVElPTlNcIikge1xuICAgIHJldHVybiBuZXcgUmVzcG9uc2UoXCJPS1wiLCB7IGhlYWRlcnMgfSk7XG4gIH1cblxuICB0cnkge1xuICAgIC8vIEdldCB0aGUgQmxvYnMgc3RvcmVcbiAgICBjb25zdCBzdG9yZSA9IGdldEJsb2JTdG9yZShjb250ZXh0KTtcblxuICAgIC8vIEdldCB0aGUgc3RhdGUga2V5IChzZXNzaW9uLXNwZWNpZmljIG9yIGRlZmF1bHQpXG4gICAgY29uc3Qgc3RhdGVLZXkgPSBnZXRTdGF0ZUtleShyZXEpO1xuXG4gICAgY29uc3QgdXJsID0gbmV3IFVSTChyZXEudXJsKTtcbiAgICBjb25zdCBwYXRoID0gdXJsLnBhdGhuYW1lLnJlcGxhY2UoXCIvLm5ldGxpZnkvZnVuY3Rpb25zL2NhbnZhcy1zdGF0ZVwiLCBcIlwiKTtcblxuICAgIC8vIExvZyBmb3IgZGVidWdnaW5nXG4gICAgY29uc29sZS5sb2coYENhbnZhcyBzdGF0ZSByZXF1ZXN0OiAke3JlcS5tZXRob2R9ICR7cGF0aH0sIHNlc3Npb246ICR7c3RhdGVLZXl9YCk7XG5cbiAgICAvLyBHRVQgL3N0YXRlIC0gR2V0IGN1cnJlbnQgc3RhdGUgKHdpdGggb3B0aW9uYWwgcmVzZXQpXG4gICAgaWYgKHJlcS5tZXRob2QgPT09IFwiR0VUXCIgJiYgKHBhdGggPT09IFwiXCIgfHwgcGF0aCA9PT0gXCIvXCIpKSB7XG4gICAgICAvLyBDaGVjayBmb3IgcmVzZXQgZmxhZyBpbiBxdWVyeSBwYXJhbXNcbiAgICAgIGNvbnN0IHNob3VsZFJlc2V0ID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJyZXNldFwiKSA9PT0gXCJ0cnVlXCI7XG5cbiAgICAgIGlmIChzaG91bGRSZXNldCkge1xuICAgICAgICBjb25zb2xlLmxvZyhgUmVzZXR0aW5nIHNlc3Npb24gdmlhIEdFVDogJHtzdGF0ZUtleX1gKTtcbiAgICAgICAgY29uc3Qgc3RhdGUgPSBhd2FpdCByZXNldFN0YXRlKHN0b3JlLCBzdGF0ZUtleSk7XG4gICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UoXG4gICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgICAuLi5zdGF0ZS5tZXRhZGF0YSxcbiAgICAgICAgICAgICAgcmVzZXQ6IHRydWUsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IFwiU2Vzc2lvbiByZXNldCBzdWNjZXNzZnVsbHlcIixcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSksXG4gICAgICAgICAge1xuICAgICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc3RhdGUgPSBhd2FpdCBnZXRTdGF0ZShzdG9yZSwgc3RhdGVLZXkpO1xuICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeShzdGF0ZSksIHtcbiAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgIGhlYWRlcnMsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBHRVQgL3Nlc3Npb25zIC0gTGlzdCBhbGwgc2Vzc2lvbnMgKGFkbWluL2RlYnVnKVxuICAgIGlmIChyZXEubWV0aG9kID09PSBcIkdFVFwiICYmIHBhdGggPT09IFwiL3Nlc3Npb25zXCIpIHtcbiAgICAgIGNvbnN0IHNlc3Npb25zID0gYXdhaXQgbGlzdFNlc3Npb25zKHN0b3JlKTtcbiAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UoXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBzZXNzaW9ucyxcbiAgICAgICAgICBjdXJyZW50U2Vzc2lvbjogc3RhdGVLZXksXG4gICAgICAgIH0pLFxuICAgICAgICB7XG4gICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBHRVQgL2hpc3RvcnkgLSBHZXQgc3RhdGUgaGlzdG9yeSAoZGVwcmVjYXRlZCBidXQga2VwdCBmb3IgY29tcGF0aWJpbGl0eSlcbiAgICBpZiAocmVxLm1ldGhvZCA9PT0gXCJHRVRcIiAmJiBwYXRoID09PSBcIi9oaXN0b3J5XCIpIHtcbiAgICAgIGNvbnN0IHN0YXRlID0gYXdhaXQgZ2V0U3RhdGUoc3RvcmUsIHN0YXRlS2V5KTtcbiAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UoXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBoaXN0b3J5OiBbXSwgLy8gTm8gbG9uZ2VyIHN0b3JpbmcgaGlzdG9yeSB3aXRoIEJsb2JzIGFwcHJvYWNoXG4gICAgICAgICAgY3VycmVudFN0YXRlOiBzdGF0ZSxcbiAgICAgICAgfSksXG4gICAgICAgIHtcbiAgICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIFBPU1QgL3VwZGF0ZSAtIFVwZGF0ZSBzdGF0ZVxuICAgIGlmIChyZXEubWV0aG9kID09PSBcIlBPU1RcIiAmJiBwYXRoID09PSBcIi91cGRhdGVcIikge1xuICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcS5qc29uKCk7XG4gICAgICBjb25zdCB7IHVwZGF0ZXMsIGFnZW50SWQgfSA9IGJvZHk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHVwZGF0ZVN0YXRlKHN0b3JlLCBzdGF0ZUtleSwgdXBkYXRlcywgYWdlbnRJZCk7XG5cbiAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UoSlNPTi5zdHJpbmdpZnkocmVzdWx0KSwge1xuICAgICAgICBzdGF0dXM6IHJlc3VsdC5zdWNjZXNzID8gMjAwIDogNDAwLFxuICAgICAgICBoZWFkZXJzLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gUE9TVCAvcmVzZXQgLSBSZXNldCBzdGF0ZVxuICAgIGlmIChyZXEubWV0aG9kID09PSBcIlBPU1RcIiAmJiBwYXRoID09PSBcIi9yZXNldFwiKSB7XG4gICAgICBjb25zdCBzdGF0ZSA9IGF3YWl0IHJlc2V0U3RhdGUoc3RvcmUsIHN0YXRlS2V5KTtcblxuICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgc3RhdGUsXG4gICAgICAgIH0pLFxuICAgICAgICB7XG4gICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBERUxFVEUgL3Nlc3Npb24gLSBEZWxldGUgYSBzcGVjaWZpYyBzZXNzaW9uXG4gICAgaWYgKHJlcS5tZXRob2QgPT09IFwiREVMRVRFXCIgJiYgcGF0aCA9PT0gXCIvc2Vzc2lvblwiKSB7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBzdG9yZS5kZWxldGUoc3RhdGVLZXkpO1xuICAgICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKFxuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBtZXNzYWdlOiBgU2Vzc2lvbiAke3N0YXRlS2V5fSBkZWxldGVkYCxcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgICAgIGhlYWRlcnMsXG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHN0YXR1czogNTAwLFxuICAgICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gTWV0aG9kIG5vdCBhbGxvd2VkXG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgZXJyb3I6IGBNZXRob2QgJHtyZXEubWV0aG9kfSBub3QgYWxsb3dlZCBmb3IgcGF0aCAke3BhdGh9YCxcbiAgICAgIH0pLFxuICAgICAge1xuICAgICAgICBzdGF0dXM6IDQwNSxcbiAgICAgICAgaGVhZGVycyxcbiAgICAgIH1cbiAgICApO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJDYW52YXMgc3RhdGUgZXJyb3I6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKFxuICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBlcnJvcjogXCJGYWlsZWQgdG8gcHJvY2VzcyBjYW52YXMgc3RhdGUgcmVxdWVzdFwiLFxuICAgICAgICBkZXRhaWxzOiBlcnJvci5tZXNzYWdlLFxuICAgICAgfSksXG4gICAgICB7XG4gICAgICAgIHN0YXR1czogNTAwLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgLi4uaGVhZGVycyxcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgfSxcbiAgICAgIH1cbiAgICApO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBoYW5kbGVyO1xuIl0s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
