
import {createRequire as ___nfyCreateRequire} from "module";
import {fileURLToPath as ___nfyFileURLToPath} from "url";
import {dirname as ___nfyPathDirname} from "path";
let __filename=___nfyFileURLToPath(import.meta.url);
let __dirname=___nfyPathDirname(___nfyFileURLToPath(import.meta.url));
let require=___nfyCreateRequire(import.meta.url);


// netlify/functions/canvas-state.js
import { getStore } from "@netlify/blobs";
var DEFAULT_STATE = {
  styleGuide: {
    conversationLanguage: "English",
    // Language of Wider Communication
    sourceLanguage: "English",
    // Translating from
    targetLanguage: "English",
    // Translating into
    languagePair: "English \u2192 English",
    // Legacy, kept for compatibility
    readingLevel: "Grade 1",
    tone: "Narrator, engaging tone",
    philosophy: "Meaning-based"
  },
  glossary: {
    terms: {}
  },
  scriptureCanvas: {
    verses: {}
  },
  feedback: {
    comments: []
  },
  workflow: {
    currentPhase: "planning",
    currentVerse: "Ruth 1:1",
    currentPhrase: 0,
    phrasesCompleted: {},
    totalPhrases: 0
  },
  metadata: {
    lastUpdated: (/* @__PURE__ */ new Date()).toISOString(),
    version: 1
  }
};
function getBlobStore(context) {
  const storeConfig = {
    name: "canvas-state"
  };
  if (context.site?.id || process.env.SITE_ID) {
    storeConfig.siteID = context.site?.id || process.env.SITE_ID;
  }
  if (context.token || process.env.NETLIFY_AUTH_TOKEN) {
    storeConfig.token = context.token || process.env.NETLIFY_AUTH_TOKEN;
  }
  return getStore(storeConfig);
}
function getStateKey(req) {
  const url = new URL(req.url);
  const sessionId = req.headers.get?.("x-session-id") || req.headers["x-session-id"] || url.searchParams.get("session");
  return sessionId ? `session_${sessionId}` : "default";
}
async function loadState(store, stateKey) {
  try {
    const data = await store.get(stateKey);
    if (data) {
      return JSON.parse(data);
    }
    return { ...DEFAULT_STATE };
  } catch (error) {
    console.error("Error loading state from Blobs:", error);
    return { ...DEFAULT_STATE };
  }
}
async function saveState(store, stateKey, state) {
  try {
    await store.set(stateKey, JSON.stringify(state));
    return true;
  } catch (error) {
    console.error("Error saving state to Blobs:", error);
    return false;
  }
}
async function getState(store, stateKey) {
  const globalState = await loadState(store, stateKey);
  return {
    ...globalState,
    metadata: {
      ...globalState.metadata,
      retrieved: (/* @__PURE__ */ new Date()).toISOString(),
      sessionId: stateKey
    }
  };
}
async function updateState(store, stateKey, updates, agentId = "user") {
  try {
    if (!updates || typeof updates !== "object") {
      throw new Error("Invalid updates provided");
    }
    let globalState = await loadState(store, stateKey);
    globalState = deepMerge(globalState, updates);
    globalState.metadata.lastUpdated = (/* @__PURE__ */ new Date()).toISOString();
    globalState.metadata.version = (globalState.metadata.version || 1) + 1;
    await saveState(store, stateKey, globalState);
    return {
      success: true,
      state: await getState(store, stateKey)
    };
  } catch (error) {
    return {
      success: false,
      error: error.message
    };
  }
}
async function resetState(store, stateKey) {
  const globalState = {
    ...DEFAULT_STATE,
    metadata: {
      lastUpdated: (/* @__PURE__ */ new Date()).toISOString(),
      version: 1,
      sessionId: stateKey
    }
  };
  await saveState(store, stateKey, globalState);
  return getState(store, stateKey);
}
async function listSessions(store) {
  try {
    const { blobs } = await store.list();
    return blobs.map((blob) => ({
      key: blob.key,
      // Extract session ID from key
      sessionId: blob.key.startsWith("session_") ? blob.key.replace("session_", "") : blob.key,
      isDefault: blob.key === "default"
    }));
  } catch (error) {
    console.error("Error listing sessions:", error);
    return [];
  }
}
function deepMerge(target, source) {
  const output = { ...target };
  if (isObject(target) && isObject(source)) {
    Object.keys(source).forEach((key) => {
      if (isObject(source[key])) {
        if (!(key in target)) {
          output[key] = source[key];
        } else {
          output[key] = deepMerge(target[key], source[key]);
        }
      } else {
        output[key] = source[key];
      }
    });
  }
  return output;
}
function isObject(item) {
  return item && typeof item === "object" && !Array.isArray(item);
}
var handler = async (req, context) => {
  const headers = {
    "Access-Control-Allow-Origin": "*",
    "Access-Control-Allow-Headers": "Content-Type, X-Session-ID",
    "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
    "Content-Type": "application/json"
  };
  if (req.method === "OPTIONS") {
    return new Response("OK", { headers });
  }
  try {
    const store = getBlobStore(context);
    const stateKey = getStateKey(req);
    const url = new URL(req.url);
    const path = url.pathname.replace("/.netlify/functions/canvas-state", "");
    console.log(`Canvas state request: ${req.method} ${path}, session: ${stateKey}`);
    if (req.method === "GET" && (path === "" || path === "/")) {
      const shouldReset = url.searchParams.get("reset") === "true";
      if (shouldReset) {
        console.log(`Resetting session via GET: ${stateKey}`);
        const state2 = await resetState(store, stateKey);
        return new Response(
          JSON.stringify({
            ...state2,
            metadata: {
              ...state2.metadata,
              reset: true,
              message: "Session reset successfully"
            }
          }),
          {
            status: 200,
            headers
          }
        );
      }
      const state = await getState(store, stateKey);
      return new Response(JSON.stringify(state), {
        status: 200,
        headers
      });
    }
    if (req.method === "GET" && path === "/sessions") {
      const sessions = await listSessions(store);
      return new Response(
        JSON.stringify({
          sessions,
          currentSession: stateKey
        }),
        {
          status: 200,
          headers
        }
      );
    }
    if (req.method === "GET" && path === "/history") {
      const state = await getState(store, stateKey);
      return new Response(
        JSON.stringify({
          history: [],
          // No longer storing history with Blobs approach
          currentState: state
        }),
        {
          status: 200,
          headers
        }
      );
    }
    if (req.method === "POST" && path === "/update") {
      const body = await req.json();
      const { updates, agentId } = body;
      const result = await updateState(store, stateKey, updates, agentId);
      return new Response(JSON.stringify(result), {
        status: result.success ? 200 : 400,
        headers
      });
    }
    if (req.method === "POST" && path === "/reset") {
      const state = await resetState(store, stateKey);
      return new Response(
        JSON.stringify({
          success: true,
          state
        }),
        {
          status: 200,
          headers
        }
      );
    }
    if (req.method === "DELETE" && path === "/session") {
      try {
        await store.delete(stateKey);
        return new Response(
          JSON.stringify({
            success: true,
            message: `Session ${stateKey} deleted`
          }),
          {
            status: 200,
            headers
          }
        );
      } catch (error) {
        return new Response(
          JSON.stringify({
            success: false,
            error: error.message
          }),
          {
            status: 500,
            headers
          }
        );
      }
    }
    return new Response(
      JSON.stringify({
        error: `Method ${req.method} not allowed for path ${path}`
      }),
      {
        status: 405,
        headers
      }
    );
  } catch (error) {
    console.error("Canvas state error:", error);
    return new Response(
      JSON.stringify({
        error: "Failed to process canvas state request",
        details: error.message
      }),
      {
        status: 500,
        headers: {
          ...headers,
          "Content-Type": "application/json"
        }
      }
    );
  }
};
var canvas_state_default = handler;
export {
  canvas_state_default as default
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibmV0bGlmeS9mdW5jdGlvbnMvY2FudmFzLXN0YXRlLmpzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyIvKipcbiAqIENhbnZhcyBTdGF0ZSBNYW5hZ2VtZW50IHdpdGggTmV0bGlmeSBCbG9ic1xuICogTWFuYWdlcyB0aGUgc3RhdGUgb2YgYWxsIGNhbnZhcyBhcnRpZmFjdHMgdXNpbmcgTmV0bGlmeSBCbG9icyBmb3IgcGVyc2lzdGVuY2VcbiAqIFRoaXMgaXMgdGhlIHNpbmdsZSBzb3VyY2Ugb2YgdHJ1dGggZm9yIHRoZSBhcHBsaWNhdGlvbiBzdGF0ZVxuICovXG5cbmltcG9ydCB7IGdldFN0b3JlIH0gZnJvbSBcIkBuZXRsaWZ5L2Jsb2JzXCI7XG5cbi8vIERlZmF1bHQgc3RhdGVcbmNvbnN0IERFRkFVTFRfU1RBVEUgPSB7XG4gIHN0eWxlR3VpZGU6IHtcbiAgICBjb252ZXJzYXRpb25MYW5ndWFnZTogXCJFbmdsaXNoXCIsIC8vIExhbmd1YWdlIG9mIFdpZGVyIENvbW11bmljYXRpb25cbiAgICBzb3VyY2VMYW5ndWFnZTogXCJFbmdsaXNoXCIsIC8vIFRyYW5zbGF0aW5nIGZyb21cbiAgICB0YXJnZXRMYW5ndWFnZTogXCJFbmdsaXNoXCIsIC8vIFRyYW5zbGF0aW5nIGludG9cbiAgICBsYW5ndWFnZVBhaXI6IFwiRW5nbGlzaCBcdTIxOTIgRW5nbGlzaFwiLCAvLyBMZWdhY3ksIGtlcHQgZm9yIGNvbXBhdGliaWxpdHlcbiAgICByZWFkaW5nTGV2ZWw6IFwiR3JhZGUgMVwiLFxuICAgIHRvbmU6IFwiTmFycmF0b3IsIGVuZ2FnaW5nIHRvbmVcIixcbiAgICBwaGlsb3NvcGh5OiBcIk1lYW5pbmctYmFzZWRcIixcbiAgfSxcbiAgZ2xvc3Nhcnk6IHtcbiAgICB0ZXJtczoge30sXG4gIH0sXG4gIHNjcmlwdHVyZUNhbnZhczoge1xuICAgIHZlcnNlczoge30sXG4gIH0sXG4gIGZlZWRiYWNrOiB7XG4gICAgY29tbWVudHM6IFtdLFxuICB9LFxuICB3b3JrZmxvdzoge1xuICAgIGN1cnJlbnRQaGFzZTogXCJwbGFubmluZ1wiLFxuICAgIGN1cnJlbnRWZXJzZTogXCJSdXRoIDE6MVwiLFxuICAgIGN1cnJlbnRQaHJhc2U6IDAsXG4gICAgcGhyYXNlc0NvbXBsZXRlZDoge30sXG4gICAgdG90YWxQaHJhc2VzOiAwLFxuICB9LFxuICBtZXRhZGF0YToge1xuICAgIGxhc3RVcGRhdGVkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgdmVyc2lvbjogMSxcbiAgfSxcbn07XG5cbi8qKlxuICogR2V0IHRoZSBOZXRsaWZ5IEJsb2JzIHN0b3JlIGZvciB0aGUgY3VycmVudCBzaXRlXG4gKi9cbmZ1bmN0aW9uIGdldEJsb2JTdG9yZShjb250ZXh0KSB7XG4gIC8vIEluIHByb2R1Y3Rpb24sIGdldFN0b3JlIHNob3VsZCB3b3JrIHdpdGhvdXQgZXhwbGljaXQgc2l0ZUlEL3Rva2VuXG4gIC8vIGFzIE5ldGxpZnkgcHJvdmlkZXMgdGhlc2UgYXV0b21hdGljYWxseSBpbiB0aGUgcnVudGltZSBlbnZpcm9ubWVudFxuICBjb25zdCBzdG9yZUNvbmZpZyA9IHtcbiAgICBuYW1lOiBcImNhbnZhcy1zdGF0ZVwiLFxuICB9O1xuXG4gIC8vIE9ubHkgYWRkIHNpdGVJRCBhbmQgdG9rZW4gaWYgdGhleSBleGlzdCAoZm9yIGxvY2FsIGRldmVsb3BtZW50KVxuICBpZiAoY29udGV4dC5zaXRlPy5pZCB8fCBwcm9jZXNzLmVudi5TSVRFX0lEKSB7XG4gICAgc3RvcmVDb25maWcuc2l0ZUlEID0gY29udGV4dC5zaXRlPy5pZCB8fCBwcm9jZXNzLmVudi5TSVRFX0lEO1xuICB9XG5cbiAgaWYgKGNvbnRleHQudG9rZW4gfHwgcHJvY2Vzcy5lbnYuTkVUTElGWV9BVVRIX1RPS0VOKSB7XG4gICAgc3RvcmVDb25maWcudG9rZW4gPSBjb250ZXh0LnRva2VuIHx8IHByb2Nlc3MuZW52Lk5FVExJRllfQVVUSF9UT0tFTjtcbiAgfVxuXG4gIHJldHVybiBnZXRTdG9yZShzdG9yZUNvbmZpZyk7XG59XG5cbi8qKlxuICogR2V0IHNlc3Npb24tc3BlY2lmaWMgc3RhdGUga2V5XG4gKi9cbmZ1bmN0aW9uIGdldFN0YXRlS2V5KHJlcSkge1xuICAvLyBDaGVjayBmb3Igc2Vzc2lvbiBJRCBpbiBoZWFkZXJzIG9yIHF1ZXJ5IHBhcmFtc1xuICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcS51cmwpO1xuICBjb25zdCBzZXNzaW9uSWQgPVxuICAgIHJlcS5oZWFkZXJzLmdldD8uKFwieC1zZXNzaW9uLWlkXCIpIHx8XG4gICAgcmVxLmhlYWRlcnNbXCJ4LXNlc3Npb24taWRcIl0gfHxcbiAgICB1cmwuc2VhcmNoUGFyYW1zLmdldChcInNlc3Npb25cIik7XG5cbiAgLy8gVXNlIHNlc3Npb24tc3BlY2lmaWMga2V5IGlmIHByb3ZpZGVkLCBvdGhlcndpc2UgdXNlIGRlZmF1bHRcbiAgcmV0dXJuIHNlc3Npb25JZCA/IGBzZXNzaW9uXyR7c2Vzc2lvbklkfWAgOiBcImRlZmF1bHRcIjtcbn1cblxuLyoqXG4gKiBMb2FkIHN0YXRlIGZyb20gQmxvYnMgb3IgcmV0dXJuIGRlZmF1bHRcbiAqL1xuYXN5bmMgZnVuY3Rpb24gbG9hZFN0YXRlKHN0b3JlLCBzdGF0ZUtleSkge1xuICB0cnkge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBzdG9yZS5nZXQoc3RhdGVLZXkpO1xuICAgIGlmIChkYXRhKSB7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShkYXRhKTtcbiAgICB9XG4gICAgLy8gTm8gZXhpc3Rpbmcgc3RhdGUsIHJldHVybiBkZWZhdWx0XG4gICAgcmV0dXJuIHsgLi4uREVGQVVMVF9TVEFURSB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBsb2FkaW5nIHN0YXRlIGZyb20gQmxvYnM6XCIsIGVycm9yKTtcbiAgICAvLyBSZXR1cm4gZGVmYXVsdCBzdGF0ZSBvbiBlcnJvclxuICAgIHJldHVybiB7IC4uLkRFRkFVTFRfU1RBVEUgfTtcbiAgfVxufVxuXG4vKipcbiAqIFNhdmUgc3RhdGUgdG8gQmxvYnNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2F2ZVN0YXRlKHN0b3JlLCBzdGF0ZUtleSwgc3RhdGUpIHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBzdG9yZS5zZXQoc3RhdGVLZXksIEpTT04uc3RyaW5naWZ5KHN0YXRlKSk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIHNhdmluZyBzdGF0ZSB0byBCbG9iczpcIiwgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vKipcbiAqIEdldCB0aGUgY3VycmVudCBzdGF0ZVxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRTdGF0ZShzdG9yZSwgc3RhdGVLZXkpIHtcbiAgY29uc3QgZ2xvYmFsU3RhdGUgPSBhd2FpdCBsb2FkU3RhdGUoc3RvcmUsIHN0YXRlS2V5KTtcbiAgcmV0dXJuIHtcbiAgICAuLi5nbG9iYWxTdGF0ZSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgLi4uZ2xvYmFsU3RhdGUubWV0YWRhdGEsXG4gICAgICByZXRyaWV2ZWQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIHNlc3Npb25JZDogc3RhdGVLZXksXG4gICAgfSxcbiAgfTtcbn1cblxuLyoqXG4gKiBVcGRhdGUgdGhlIHN0YXRlIHdpdGggdmFsaWRhdGlvblxuICovXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVTdGF0ZShzdG9yZSwgc3RhdGVLZXksIHVwZGF0ZXMsIGFnZW50SWQgPSBcInVzZXJcIikge1xuICB0cnkge1xuICAgIC8vIFZhbGlkYXRlIHVwZGF0ZXNcbiAgICBpZiAoIXVwZGF0ZXMgfHwgdHlwZW9mIHVwZGF0ZXMgIT09IFwib2JqZWN0XCIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdXBkYXRlcyBwcm92aWRlZFwiKTtcbiAgICB9XG5cbiAgICAvLyBMb2FkIGN1cnJlbnQgc3RhdGVcbiAgICBsZXQgZ2xvYmFsU3RhdGUgPSBhd2FpdCBsb2FkU3RhdGUoc3RvcmUsIHN0YXRlS2V5KTtcblxuICAgIC8vIEFwcGx5IHVwZGF0ZXMgKGRlZXAgbWVyZ2UpXG4gICAgZ2xvYmFsU3RhdGUgPSBkZWVwTWVyZ2UoZ2xvYmFsU3RhdGUsIHVwZGF0ZXMpO1xuXG4gICAgLy8gVXBkYXRlIG1ldGFkYXRhXG4gICAgZ2xvYmFsU3RhdGUubWV0YWRhdGEubGFzdFVwZGF0ZWQgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gICAgZ2xvYmFsU3RhdGUubWV0YWRhdGEudmVyc2lvbiA9IChnbG9iYWxTdGF0ZS5tZXRhZGF0YS52ZXJzaW9uIHx8IDEpICsgMTtcblxuICAgIC8vIFNhdmUgdG8gQmxvYnNcbiAgICBhd2FpdCBzYXZlU3RhdGUoc3RvcmUsIHN0YXRlS2V5LCBnbG9iYWxTdGF0ZSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHN0YXRlOiBhd2FpdCBnZXRTdGF0ZShzdG9yZSwgc3RhdGVLZXkpLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIFJlc2V0IHN0YXRlIHRvIGluaXRpYWwgdmFsdWVzXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHJlc2V0U3RhdGUoc3RvcmUsIHN0YXRlS2V5KSB7XG4gIGNvbnN0IGdsb2JhbFN0YXRlID0ge1xuICAgIC4uLkRFRkFVTFRfU1RBVEUsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIGxhc3RVcGRhdGVkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB2ZXJzaW9uOiAxLFxuICAgICAgc2Vzc2lvbklkOiBzdGF0ZUtleSxcbiAgICB9LFxuICB9O1xuICBhd2FpdCBzYXZlU3RhdGUoc3RvcmUsIHN0YXRlS2V5LCBnbG9iYWxTdGF0ZSk7XG4gIHJldHVybiBnZXRTdGF0ZShzdG9yZSwgc3RhdGVLZXkpO1xufVxuXG4vKipcbiAqIExpc3QgYWxsIHNlc3Npb25zIChmb3IgYWRtaW4vZGVidWcgcHVycG9zZXMpXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGxpc3RTZXNzaW9ucyhzdG9yZSkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgYmxvYnMgfSA9IGF3YWl0IHN0b3JlLmxpc3QoKTtcbiAgICByZXR1cm4gYmxvYnMubWFwKChibG9iKSA9PiAoe1xuICAgICAga2V5OiBibG9iLmtleSxcbiAgICAgIC8vIEV4dHJhY3Qgc2Vzc2lvbiBJRCBmcm9tIGtleVxuICAgICAgc2Vzc2lvbklkOiBibG9iLmtleS5zdGFydHNXaXRoKFwic2Vzc2lvbl9cIikgPyBibG9iLmtleS5yZXBsYWNlKFwic2Vzc2lvbl9cIiwgXCJcIikgOiBibG9iLmtleSxcbiAgICAgIGlzRGVmYXVsdDogYmxvYi5rZXkgPT09IFwiZGVmYXVsdFwiLFxuICAgIH0pKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgbGlzdGluZyBzZXNzaW9uczpcIiwgZXJyb3IpO1xuICAgIHJldHVybiBbXTtcbiAgfVxufVxuXG4vKipcbiAqIERlZXAgbWVyZ2UgdXRpbGl0eSBmdW5jdGlvblxuICovXG5mdW5jdGlvbiBkZWVwTWVyZ2UodGFyZ2V0LCBzb3VyY2UpIHtcbiAgY29uc3Qgb3V0cHV0ID0geyAuLi50YXJnZXQgfTtcblxuICBpZiAoaXNPYmplY3QodGFyZ2V0KSAmJiBpc09iamVjdChzb3VyY2UpKSB7XG4gICAgT2JqZWN0LmtleXMoc291cmNlKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgIGlmIChpc09iamVjdChzb3VyY2Vba2V5XSkpIHtcbiAgICAgICAgaWYgKCEoa2V5IGluIHRhcmdldCkpIHtcbiAgICAgICAgICBvdXRwdXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG91dHB1dFtrZXldID0gZGVlcE1lcmdlKHRhcmdldFtrZXldLCBzb3VyY2Vba2V5XSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG91dHB1dFtrZXldID0gc291cmNlW2tleV07XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gb3V0cHV0O1xufVxuXG5mdW5jdGlvbiBpc09iamVjdChpdGVtKSB7XG4gIHJldHVybiBpdGVtICYmIHR5cGVvZiBpdGVtID09PSBcIm9iamVjdFwiICYmICFBcnJheS5pc0FycmF5KGl0ZW0pO1xufVxuXG4vKipcbiAqIE5ldGxpZnkgRnVuY3Rpb24gSGFuZGxlclxuICovXG5jb25zdCBoYW5kbGVyID0gYXN5bmMgKHJlcSwgY29udGV4dCkgPT4ge1xuICAvLyBFbmFibGUgQ09SU1xuICBjb25zdCBoZWFkZXJzID0ge1xuICAgIFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luXCI6IFwiKlwiLFxuICAgIFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVyc1wiOiBcIkNvbnRlbnQtVHlwZSwgWC1TZXNzaW9uLUlEXCIsXG4gICAgXCJBY2Nlc3MtQ29udHJvbC1BbGxvdy1NZXRob2RzXCI6IFwiR0VULCBQT1NULCBQVVQsIERFTEVURSwgT1BUSU9OU1wiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9O1xuXG4gIC8vIEhhbmRsZSBwcmVmbGlnaHRcbiAgaWYgKHJlcS5tZXRob2QgPT09IFwiT1BUSU9OU1wiKSB7XG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZShcIk9LXCIsIHsgaGVhZGVycyB9KTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgLy8gR2V0IHRoZSBCbG9icyBzdG9yZVxuICAgIGNvbnN0IHN0b3JlID0gZ2V0QmxvYlN0b3JlKGNvbnRleHQpO1xuXG4gICAgLy8gR2V0IHRoZSBzdGF0ZSBrZXkgKHNlc3Npb24tc3BlY2lmaWMgb3IgZGVmYXVsdClcbiAgICBjb25zdCBzdGF0ZUtleSA9IGdldFN0YXRlS2V5KHJlcSk7XG5cbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcS51cmwpO1xuICAgIGNvbnN0IHBhdGggPSB1cmwucGF0aG5hbWUucmVwbGFjZShcIi8ubmV0bGlmeS9mdW5jdGlvbnMvY2FudmFzLXN0YXRlXCIsIFwiXCIpO1xuXG4gICAgLy8gTG9nIGZvciBkZWJ1Z2dpbmdcbiAgICBjb25zb2xlLmxvZyhgQ2FudmFzIHN0YXRlIHJlcXVlc3Q6ICR7cmVxLm1ldGhvZH0gJHtwYXRofSwgc2Vzc2lvbjogJHtzdGF0ZUtleX1gKTtcblxuICAgIC8vIEdFVCAvc3RhdGUgLSBHZXQgY3VycmVudCBzdGF0ZSAod2l0aCBvcHRpb25hbCByZXNldClcbiAgICBpZiAocmVxLm1ldGhvZCA9PT0gXCJHRVRcIiAmJiAocGF0aCA9PT0gXCJcIiB8fCBwYXRoID09PSBcIi9cIikpIHtcbiAgICAgIC8vIENoZWNrIGZvciByZXNldCBmbGFnIGluIHF1ZXJ5IHBhcmFtc1xuICAgICAgY29uc3Qgc2hvdWxkUmVzZXQgPSB1cmwuc2VhcmNoUGFyYW1zLmdldChcInJlc2V0XCIpID09PSBcInRydWVcIjtcbiAgICAgIFxuICAgICAgaWYgKHNob3VsZFJlc2V0KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBSZXNldHRpbmcgc2Vzc2lvbiB2aWEgR0VUOiAke3N0YXRlS2V5fWApO1xuICAgICAgICBjb25zdCBzdGF0ZSA9IGF3YWl0IHJlc2V0U3RhdGUoc3RvcmUsIHN0YXRlS2V5KTtcbiAgICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgIC4uLnN0YXRlLm1ldGFkYXRhLFxuICAgICAgICAgICAgICByZXNldDogdHJ1ZSxcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJTZXNzaW9uIHJlc2V0IHN1Y2Nlc3NmdWxseVwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSksIFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHN0YXRlID0gYXdhaXQgZ2V0U3RhdGUoc3RvcmUsIHN0YXRlS2V5KTtcbiAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UoSlNPTi5zdHJpbmdpZnkoc3RhdGUpLCB7XG4gICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICBoZWFkZXJzLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9zZXNzaW9ucyAtIExpc3QgYWxsIHNlc3Npb25zIChhZG1pbi9kZWJ1ZylcbiAgICBpZiAocmVxLm1ldGhvZCA9PT0gXCJHRVRcIiAmJiBwYXRoID09PSBcIi9zZXNzaW9uc1wiKSB7XG4gICAgICBjb25zdCBzZXNzaW9ucyA9IGF3YWl0IGxpc3RTZXNzaW9ucyhzdG9yZSk7XG4gICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKFxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgc2Vzc2lvbnMsXG4gICAgICAgICAgY3VycmVudFNlc3Npb246IHN0YXRlS2V5LFxuICAgICAgICB9KSxcbiAgICAgICAge1xuICAgICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICAgIGhlYWRlcnMsXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9oaXN0b3J5IC0gR2V0IHN0YXRlIGhpc3RvcnkgKGRlcHJlY2F0ZWQgYnV0IGtlcHQgZm9yIGNvbXBhdGliaWxpdHkpXG4gICAgaWYgKHJlcS5tZXRob2QgPT09IFwiR0VUXCIgJiYgcGF0aCA9PT0gXCIvaGlzdG9yeVwiKSB7XG4gICAgICBjb25zdCBzdGF0ZSA9IGF3YWl0IGdldFN0YXRlKHN0b3JlLCBzdGF0ZUtleSk7XG4gICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKFxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgaGlzdG9yeTogW10sIC8vIE5vIGxvbmdlciBzdG9yaW5nIGhpc3Rvcnkgd2l0aCBCbG9icyBhcHByb2FjaFxuICAgICAgICAgIGN1cnJlbnRTdGF0ZTogc3RhdGUsXG4gICAgICAgIH0pLFxuICAgICAgICB7XG4gICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC91cGRhdGUgLSBVcGRhdGUgc3RhdGVcbiAgICBpZiAocmVxLm1ldGhvZCA9PT0gXCJQT1NUXCIgJiYgcGF0aCA9PT0gXCIvdXBkYXRlXCIpIHtcbiAgICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXEuanNvbigpO1xuICAgICAgY29uc3QgeyB1cGRhdGVzLCBhZ2VudElkIH0gPSBib2R5O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB1cGRhdGVTdGF0ZShzdG9yZSwgc3RhdGVLZXksIHVwZGF0ZXMsIGFnZW50SWQpO1xuXG4gICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKEpTT04uc3RyaW5naWZ5KHJlc3VsdCksIHtcbiAgICAgICAgc3RhdHVzOiByZXN1bHQuc3VjY2VzcyA/IDIwMCA6IDQwMCxcbiAgICAgICAgaGVhZGVycyxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFBPU1QgL3Jlc2V0IC0gUmVzZXQgc3RhdGVcbiAgICBpZiAocmVxLm1ldGhvZCA9PT0gXCJQT1NUXCIgJiYgcGF0aCA9PT0gXCIvcmVzZXRcIikge1xuICAgICAgY29uc3Qgc3RhdGUgPSBhd2FpdCByZXNldFN0YXRlKHN0b3JlLCBzdGF0ZUtleSk7XG5cbiAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UoXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIHN0YXRlLFxuICAgICAgICB9KSxcbiAgICAgICAge1xuICAgICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICAgIGhlYWRlcnMsXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gREVMRVRFIC9zZXNzaW9uIC0gRGVsZXRlIGEgc3BlY2lmaWMgc2Vzc2lvblxuICAgIGlmIChyZXEubWV0aG9kID09PSBcIkRFTEVURVwiICYmIHBhdGggPT09IFwiL3Nlc3Npb25cIikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgc3RvcmUuZGVsZXRlKHN0YXRlS2V5KTtcbiAgICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgbWVzc2FnZTogYFNlc3Npb24gJHtzdGF0ZUtleX0gZGVsZXRlZGAsXG4gICAgICAgICAgfSksXG4gICAgICAgICAge1xuICAgICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UoXG4gICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBzdGF0dXM6IDUwMCxcbiAgICAgICAgICAgIGhlYWRlcnMsXG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE1ldGhvZCBub3QgYWxsb3dlZFxuICAgIHJldHVybiBuZXcgUmVzcG9uc2UoXG4gICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGVycm9yOiBgTWV0aG9kICR7cmVxLm1ldGhvZH0gbm90IGFsbG93ZWQgZm9yIHBhdGggJHtwYXRofWAsXG4gICAgICB9KSxcbiAgICAgIHtcbiAgICAgICAgc3RhdHVzOiA0MDUsXG4gICAgICAgIGhlYWRlcnMsXG4gICAgICB9XG4gICAgKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiQ2FudmFzIHN0YXRlIGVycm9yOlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgZXJyb3I6IFwiRmFpbGVkIHRvIHByb2Nlc3MgY2FudmFzIHN0YXRlIHJlcXVlc3RcIixcbiAgICAgICAgZGV0YWlsczogZXJyb3IubWVzc2FnZSxcbiAgICAgIH0pLFxuICAgICAge1xuICAgICAgICBzdGF0dXM6IDUwMCxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIC4uLmhlYWRlcnMsXG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgIH0sXG4gICAgICB9XG4gICAgKTtcbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgaGFuZGxlcjtcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7QUFNQSxTQUFTLGdCQUFnQjtBQUd6QixJQUFNLGdCQUFnQjtBQUFBLEVBQ3BCLFlBQVk7QUFBQSxJQUNWLHNCQUFzQjtBQUFBO0FBQUEsSUFDdEIsZ0JBQWdCO0FBQUE7QUFBQSxJQUNoQixnQkFBZ0I7QUFBQTtBQUFBLElBQ2hCLGNBQWM7QUFBQTtBQUFBLElBQ2QsY0FBYztBQUFBLElBQ2QsTUFBTTtBQUFBLElBQ04sWUFBWTtBQUFBLEVBQ2Q7QUFBQSxFQUNBLFVBQVU7QUFBQSxJQUNSLE9BQU8sQ0FBQztBQUFBLEVBQ1Y7QUFBQSxFQUNBLGlCQUFpQjtBQUFBLElBQ2YsUUFBUSxDQUFDO0FBQUEsRUFDWDtBQUFBLEVBQ0EsVUFBVTtBQUFBLElBQ1IsVUFBVSxDQUFDO0FBQUEsRUFDYjtBQUFBLEVBQ0EsVUFBVTtBQUFBLElBQ1IsY0FBYztBQUFBLElBQ2QsY0FBYztBQUFBLElBQ2QsZUFBZTtBQUFBLElBQ2Ys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
